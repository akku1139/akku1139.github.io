---
title: MediaTek Clock Dumper
summary: このアプリケーションはGemini 3 Flashによって生成されたコードが含まれます
---

<script>
const clks = {
  "CG_PERI0": [
    "nfi",
    "therm",
    "pwm1",
    "pwm2",
    "pwm3",
    "pwm4",
    "pwm5",
    "pwm6",
    "pwm7",
    "pwm",
    "usb0",
    "usb1",
    "apdma",
    "msdc0",
    "msdc1",
    "msdc2",
    "msdc3",
    "msdc4",
    "aphif",
    "mdhif",
    "nli",
    "irda",
    "uart0",
    "uart1",
    "uart2",
    "uart3",
    "i2c0",
    "i2c1",
    "i2c2",
    "i2c3",
    "i2c4",
    "i2c5"
  ],
  "CG_PERI1": [
    "i2c6",
    "wrap",
    "auxadc",
    "spi1",
    "fhctl",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  "CG_INFRA": [
    "dbgclk",
    "smi",
    "spi0",
    null,
    null,
    "audio",
    "cec",
    "mfgaxi",
    "m4u",
    "md1mcuaxi",
    "md1hwmixaxi",
    "md1ahb",
    "md2mcuaxi",
    "md2hwmixaxi",
    "md2ahb",
    "cpum",
    "kp",
    null,
    null,
    null,
    "ccif0",
    "ccif1",
    "pmicspi",
    "pmicwrap",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  "CG_TOPCK": [
    "pmicspi",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  "CG_DISP0": [
    null,
    null,
    null,
    "scl",
    null,
    null,
    "color",
    "2dshp",
    "bls",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  "CG_DISP1": [
    null,
    null,
    null,
    null,
    null,
    null,
    "dpi0",
    "dpi1",
    "lcd",
    "slcd",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  "CG_IMAGE": [
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    "fpc",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  "CG_MFG": [
    "axi",
    "mem",
    "g3d",
    "hyd",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  "CG_AUDIO": [
    null,
    null,
    "afe",
    null,
    null,
    null,
    "i2s",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  "CG_VDEC0": [
    "vde",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  "CG_VDEC1": [
    "smi",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ],
  "CG_VENC": [
    "ven",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null
  ]
}

// 定数の定義
const PWR_DOWN = 0;
const PWR_ON = 1;

/**
 * マスクの生成
 * @param {number} bit - シフトする量 (例: 3ビット目なら3)
 * @returns {number} 1をbit分シフトした値
 */
const createMask = (bit) => 1 << bit;

// --- 各オペレーションの実装 ---

// general_clk_get_state_op 相当
const generalClkGetState = (sysState, regValue, mask) => {
    // sys && !sys->state のチェック
    if (sysState !== undefined && !sysState) {
        return PWR_DOWN;
    }
    // (reg & mask) ? PWR_DOWN : PWR_ON
    // 特定のビットが立っている(1)と「DOWN」と判定するロジック
    return (regValue & mask) ? PWR_DOWN : PWR_ON;
};

// vdec_clk_get_state_op / venc_clk_get_state_op 相当
const simpleClkGetState = (regValue, mask) => {
    // (reg & mask) ? PWR_ON : PWR_DOWN
    // 特定のビットが立っている(1)と「ON」と判定するロジック
    return (regValue & mask) ? PWR_ON : PWR_DOWN;
};

/*
// --- 使用例 ---
const mask = createMask(5);      // 5ビット目のマスク (0010 0000 = 32)
const regVal = 0b00101100;       // 仮のレジスタ値（5ビット目が1）

console.log(simpleClkGetState(regVal, mask)); // 結果: 1 (PWR_ON)
*/

/*
const rawData = `********** clk register dump **********
[00][CG_PERI0]=[0xffafebfd]
[01][CG_PERI1]=[0x00000009]
[02][CG_INFRA]=[0x00008040]
[03][CG_TOPCK]=[0x00000000]
[04][CG_DISP0]=[0xffff1e8e]
[05][CG_DISP1]=[0xffffffc7]
[06][CG_IMAGE]=[0x00000000]
[07][CG_MFG  ]=[0x00000000]
[08][CG_AUDIO]=[0x80394078]
[09][CG_VDEC0]=[0x00000000][0x00000000]
[10][CG_VDEC1]=[0x00000000][0x00000000]
[11][CG_VENC ]=[0x00000000]
[PERI_PDN_MD_MASK]=0x00000001
[PERI_PDN0_MD1_STA]=0x00000000
[PERI_PDN0_MD2_STA]=0xffffffff`
*/

const parseClockRegisters = (text) => {
  const result = {};
  // 正規表現の解説:
  // \[CG_([^\]\s]+)\s*\] : "CG_"から始まり、空白または"]"までの文字列をキャプチャ
  // =\[(0x[0-9a-fA-F]+)\] : "=" の後の最初の "[0x...]" 内の値をキャプチャ
  const regex = /\[CG_([^\]\s]+)\s*\]=\[(0x[0-9a-fA-F]+)\]/g;

  let match;
  while ((match = regex.exec(text)) !== null) {
    const key = `CG_${match[1]}`;
    const value = match[2];
    result[key] = value;
  }

  return result;
};

/*
const clkData = parseClockRegisters(rawData);
console.log(clkData);
*/

let data = '';
let parsed = parseClockRegisters(data);

</script>

<textarea class="clk_test"></textarea>
